<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Links Platform</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="header">
        <img src="vectmaarif.png" alt="Maarif Logo" class="header-logo left-logo">
        <h1 class="header-title">IMST Dashboard 2024-2025</h1>
        <img src="vectcambridge.png" alt="Cambridge Logo" class="header-logo right-logo">
    </header>

    <div class="container">
        <!-- Frame 1 - Attendance -->
        <div class="frame">
            <h2>Attendance</h2>
            <p class="note">Teachers' duty is to fill in attendance at the end of the first session, and nurses' duty is to record the reason for absence.</p>
            <select id="yearSelect">
                <option value="year0">Year 0</option>
                <option value="year1">Year 1</option>
                <option value="year2">Year 2</option>
                <option value="year3">Year 3</option>
                <option value="year4">Year 4</option>
                <option value="year5">Year 5</option>
                <option value="year6A">Year 6.A</option>
                <option value="year6B">Year 6.B</option>
                <option value="year7">Year 7</option>
                <option value="year8">Year 8</option>
                <option value="year9">Year 9</option>
                <option value="year10">Year 10</option>
                <option value="year11">Year 11</option>
                <option value="year12">Year 12</option>
                <option value="year13">Year 13</option>
            </select>
            <button onclick="accessAttendance()">Access Attendance</button>
        </div>

        <!-- Frame 2 - Weekly Reports -->
        <div class="frame">
            <h2>Weekly Reports</h2>
            <p class="note">Weekly reports will be automatically sent every Thursday at 17:00.</p>
            <button onclick="accessWeeklyReports('LAC')">LAC Weekly Reports</button>
            <button onclick="accessWeeklyReports('Charguia')">Charguia Weekly Reports</button>
        </div>

        <!-- Frame 3 - Grade Submission -->
        <div class="frame">
            <h2>Grade Submission</h2>
            <p class="note">Each teacher has a passcode to access and submit grades for their subjects.</p>
            <form onsubmit="redirectToResults(); return false;">
                <input type="text" id="passcode" placeholder="Enter Passcode" required>
                <button type="submit">Access Sheets</button>
            </form>
        </div>

        <!-- Frame 4 - Report Cards -->
        <div class="frame">
            <h2>Report Cards</h2>
            <p class="note">Homeroom teachers can access the report cards for a check before printing.</p>
            <input type="text" id="reportPasscode" placeholder="Enter Passcode">
            <button onclick="accessReportCards()">Access Report Cards</button>
        </div>

        <!-- Frame 5 - Students Lists -->
        <div class="frame">
            <h2>Students Lists</h2>
            <p class="note">Teachers can access the list of students.</p>
            <button onclick="accessStudentLists()">Access Students Lists</button>
        </div>

        <!-- Frame 6 - School Database -->
        <div class="frame">
            <h2>School Database</h2>
            <p class="note">Admin officers can access our school database.</p>
            <input type="text" id="databasePasscode" placeholder="Enter Passcode">
            <button onclick="accessSchoolDatabase()">Access Database</button>
        </div>

        <!-- Frame 7 - Pedagogic Resources -->
        <div class="frame">
            <h2>Pedagogic Resources</h2>
            <p class="note">Teachers can access their personal workspace and submit their pedagogic resources.</p>
            <input type="text" id="resourcesPasscode" placeholder="Enter Passcode">
            <button onclick="accessPedagogicResources()">Access My Workspace</button>
        </div>
    </div>

    <footer class="footer">
        <p>Admin staff have a supercode to access everything.</p>
    </footer>

    <script>
     async function fetchJson(file) {
    const response = await fetch(file);
    return await response.json();
}

async function accessAttendance() {
    try {
        const year = document.getElementById('yearSelect').value;
        const links = await fetchJson('links.json');
        const url = links[`attendance_sheet_${year}`];
        if (url) {
            window.open(url, '_blank'); // Opens in a new tab
        } else {
            alert('No attendance sheet found for the selected year.');
        }
    } catch (error) {
        console.error('Error accessing attendance:', error);
    }
}

async function accessWeeklyReports(location) {
    try {
        const links = await fetchJson('links.json');
        const url = location === 'LAC' ? links.weekly_reports_link : links.charguia_weekly_reports_link;
        if (url) {
            window.open(url, '_blank'); // Opens in a new tab
        } else {
            alert(`No weekly report found for ${location}.`);
        }
    } catch (error) {
        console.error('Error accessing weekly reports:', error);
    }
}

async function accessStudentLists() {
    try {
        const links = await fetchJson('links.json');
        const url = links.student_lists_link;
        if (url) {
            window.open(url, '_blank'); // Opens in a new tab
        } else {
            alert('No student list found.');
        }
    } catch (error) {
        console.error('Error accessing student lists:', error);
    }
}

async function accessSchoolDatabase() {
    try {
        const passcode = document.getElementById('databasePasscode').value;
        const passcodes = await fetchJson('passcodes.json');
        const links = await fetchJson('links.json');

        if (passcodes[passcode] && passcode === 'admin') {
            window.open(links.school_database_link_admin, '_blank'); // Opens admin link in a new tab
        } else if (passcodes[passcode] && passcodes[passcode].years && passcodes[passcode].years.admin) {
            window.open(links.school_database_link_admin, '_blank'); // Opens in a new tab for specific passcode
        } else {
            window.location.href = `results.html?error=invalid_passcode`;
        }
    } catch (error) {
        console.error('Error accessing school database:', error);
    }
}

async function accessPedagogicResources() {
    try {
        const passcode = document.getElementById('resourcesPasscode').value;
        const passcodes = await fetchJson('passcodes.json');
        const links = await fetchJson('links.json');

        if (passcodes[passcode] && passcode === 'admin') {
            window.open(links.pedagogic_resources_link_admin, '_blank'); // Opens admin link in a new tab
        } else if (passcodes[passcode] && passcodes[passcode].years && passcodes[passcode].years.pedagogic) {
            const workspaceLink = passcodes[passcode].years.pedagogic;
            window.open(workspaceLink, '_blank'); // Opens specific workspace link
        } else {
            window.location.href = `results.html?error=invalid_passcode`;
        }
    } catch (error) {
        console.error('Error accessing pedagogic resources:', error);
    }
}

function redirectToResults() {
    try {
        const passcode = document.getElementById('passcode').value;
        window.location.href = `results.html?passcode=${passcode}`;
    } catch (error) {
        console.error('Error redirecting to results:', error);
    }
}

async function accessReportCards() {
    try {
        const passcode = document.getElementById('reportPasscode').value;
        const passcodes = await fetchJson('passcodes.json');
        if (passcodes[passcode]) {
            window.location.href = `results.html?passcode=${passcode}`;
        } else {
            window.location.href = `results.html?error=invalid_passcode`;
        }
    } catch (error) {
        console.error('Error accessing report cards:', error);
    }
}

    </script>
</body>
</html>
